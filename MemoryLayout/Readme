# c++虚表和虚表指针的内存分布

检测方法（VS2015）
项目命令行加上参数/d1reportAllClassLayout，在编译时CTRL+F5搜索输出，查看类的对象布局。
vftable - 虚函数表; vbtable - 虚继承的父类表; member - 类的成员变量（这个只是写作方便说明 = =）。

总结一
继承方式：非virtual继承：导入各个父类的结构（按照父类声明的顺序，从上到下），自身member在最后
重写virtual方法：更新该方法最早定义的类的vftable
新的virtual方法：在最左父类的vftable增加
继承方式：有virtual继承：在自身member后增加virtual父类的结构（按照子类继承的顺序从左到右），同时在最前面增加vbtable（如果没有的话），
增加一项指向父类结构
重写virtual方法：更新该方法的最早定义的类的vftable
新的virtual方法：在自身最前面增加vftable（如果没有的话），在自己的vftable增加

总结二
当基类有虚函数时:
每个类都有虚指针和虚表；
如果不是虚继承，那么子类将父类的虚指针继承下来，并指向自身的虚表（发生在对象构造时）。有多少个虚函数，虚表里面的项就会有多少。多重继承时，
可能存在多个的基类虚表与虚指针；
如果是虚继承，那么子类会有两份虚指针，一份指向自己的虚表，另一份指向虚基表，多重继承时虚基表与虚基表指针有且只有一份。

Reference
http://yoyo.is-programmer.com/posts/10671.html
